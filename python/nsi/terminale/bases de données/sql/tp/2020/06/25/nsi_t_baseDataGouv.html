<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Exploiter un vrai jeu de donnée | notebooks</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Exploiter un vrai jeu de donnée" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Cours NSI Terminale - Thème 2." />
<meta property="og:description" content="Cours NSI Terminale - Thème 2." />
<link rel="canonical" href="https://notebooks.lecluse.fr/python/nsi/terminale/bases%20de%20donn%C3%A9es/sql/tp/2020/06/25/nsi_t_baseDataGouv.html" />
<meta property="og:url" content="https://notebooks.lecluse.fr/python/nsi/terminale/bases%20de%20donn%C3%A9es/sql/tp/2020/06/25/nsi_t_baseDataGouv.html" />
<meta property="og:site_name" content="notebooks" />
<meta property="og:image" content="https://notebooks.lecluse.fr/images/nsi2.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-06-25T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"Cours NSI Terminale - Thème 2.","mainEntityOfPage":{"@type":"WebPage","@id":"https://notebooks.lecluse.fr/python/nsi/terminale/bases%20de%20donn%C3%A9es/sql/tp/2020/06/25/nsi_t_baseDataGouv.html"},"@type":"BlogPosting","url":"https://notebooks.lecluse.fr/python/nsi/terminale/bases%20de%20donn%C3%A9es/sql/tp/2020/06/25/nsi_t_baseDataGouv.html","headline":"Exploiter un vrai jeu de donnée","dateModified":"2020-06-25T00:00:00-05:00","datePublished":"2020-06-25T00:00:00-05:00","image":"https://notebooks.lecluse.fr/images/nsi2.png","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://notebooks.lecluse.fr/feed.xml" title="notebooks" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Exploiter un vrai jeu de donnée | notebooks</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Exploiter un vrai jeu de donnée" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Cours NSI Terminale - Thème 2." />
<meta property="og:description" content="Cours NSI Terminale - Thème 2." />
<link rel="canonical" href="https://notebooks.lecluse.fr/python/nsi/terminale/bases%20de%20donn%C3%A9es/sql/tp/2020/06/25/nsi_t_baseDataGouv.html" />
<meta property="og:url" content="https://notebooks.lecluse.fr/python/nsi/terminale/bases%20de%20donn%C3%A9es/sql/tp/2020/06/25/nsi_t_baseDataGouv.html" />
<meta property="og:site_name" content="notebooks" />
<meta property="og:image" content="https://notebooks.lecluse.fr/images/nsi2.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-06-25T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"Cours NSI Terminale - Thème 2.","mainEntityOfPage":{"@type":"WebPage","@id":"https://notebooks.lecluse.fr/python/nsi/terminale/bases%20de%20donn%C3%A9es/sql/tp/2020/06/25/nsi_t_baseDataGouv.html"},"@type":"BlogPosting","url":"https://notebooks.lecluse.fr/python/nsi/terminale/bases%20de%20donn%C3%A9es/sql/tp/2020/06/25/nsi_t_baseDataGouv.html","headline":"Exploiter un vrai jeu de donnée","dateModified":"2020-06-25T00:00:00-05:00","datePublished":"2020-06-25T00:00:00-05:00","image":"https://notebooks.lecluse.fr/images/nsi2.png","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://notebooks.lecluse.fr/feed.xml" title="notebooks" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">notebooks</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">A propos</a><a class="page-link" href="/">Notebooks Jupyter</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a><a class="page-link" href="/page2/">Notebooks Jupyter</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Exploiter un vrai jeu de donnée</h1><p class="page-description">Cours NSI Terminale - Thème 2.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-06-25T00:00:00-05:00" itemprop="datePublished">
        Jun 25, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#NSI">NSI</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Terminale">Terminale</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Bases de données">Bases de données</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#SQL">SQL</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#TP">TP</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/wawachief/fp-notebooks/tree/master/_notebooks/2020-06-25-nsi_t_baseDataGouv.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/wawachief/fp-notebooks/master?filepath=_notebooks%2F2020-06-25-nsi_t_baseDataGouv.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/wawachief/fp-notebooks/blob/master/_notebooks/2020-06-25-nsi_t_baseDataGouv.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Mise-en-pratique-sur-une-vraie-base">Mise en pratique sur une vraie base </a></li>
<li class="toc-entry toc-h2"><a href="#Exemple-de-jeu-de-données">Exemple de jeu de données </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Création-des-tables">Création des tables </a></li>
<li class="toc-entry toc-h3"><a href="#Alimentation-de-la-base-de-données">Alimentation de la base de données </a></li>
<li class="toc-entry toc-h3"><a href="#Interrogation-de-la-base-de-données">Interrogation de la base de données </a></li>
<li class="toc-entry toc-h3"><a href="#Quelques-idées-de-fonctions-à-créer-!">Quelques idées de fonctions à créer ! </a></li>
<li class="toc-entry toc-h3"><a href="#Amusez-vous">Amusez vous </a></li>
<li class="toc-entry toc-h3"><a href="#Pour-aller-plus-loin">Pour aller plus loin </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Fin-du-travail">Fin du travail </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-06-25-nsi_t_baseDataGouv.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mise-en-pratique-sur-une-vraie-base">
<a class="anchor" href="#Mise-en-pratique-sur-une-vraie-base" aria-hidden="true"><span class="octicon octicon-link"></span></a>Mise en pratique sur une vraie base<a class="anchor-link" href="#Mise-en-pratique-sur-une-vraie-base"> </a>
</h2>
<p>A partir de maintenant, vous avez les connaissances pour réaliser une application s'appuyant sur une base de donénes. Il  ne reste plus qu'à les appliquer dans le cadre d'un projet ou un mini projet. Un exemple de mini-projet possible dans le domaine du <em>BigData</em> consiste à récupérer des données officielles et à s'aider du langage SQL pour les exploiter.</p>
<h2 id="Exemple-de-jeu-de-données">
<a class="anchor" href="#Exemple-de-jeu-de-donn%C3%A9es" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exemple de jeu de données<a class="anchor-link" href="#Exemple-de-jeu-de-donn%C3%A9es"> </a>
</h2>
<p>Une source intéressante pour récupérer des données est <strong>data.gouv.fr</strong>. Voici un exemple de jeu de données : <a href="https://www.data.gouv.fr/fr/datasets/resultats-du-controle-sanitaire-de-leau-distribuee-commune-par-commune/#_">https://www.data.gouv.fr/fr/datasets/resultats-du-controle-sanitaire-de-leau-distribuee-commune-par-commune/#_</a></p>
<p>La description de chacun des fichiers se trouve ici : <a href="https://static.data.gouv.fr/resources/resultats-du-controle-sanitaire-de-leau-distribuee-commune-par-commune/20190710-030936/20190708-eau-distrib-documentation-v4.pdf">https://static.data.gouv.fr/resources/resultats-du-controle-sanitaire-de-leau-distribuee-commune-par-commune/20190710-030936/20190708-eau-distrib-documentation-v4.pdf</a></p>
<ol>
<li>Téléchargez le fichier dis-* le plus récent. Décompressez le et anasysez sa structure.</li>
<li>Créez une nouvelle base de données et 3 tables à l'intérieur :<ul>
<li>Communes</li>
<li>Prelevements</li>
<li>Resultats</li>
</ul>
</li>
<li>Créez dans chacune des tables une clé primaire nommée Id<em>NomTable</em> ainsi que des attributs correspondants aux intitulés de colonne</li>
<li>A l'aide de Python, lisez chacun des fichiers et peuplez les tables correspondantes.</li>
<li>Créez des requêtes SQL afin de vous renseigner sur la qualité de l'eau dans les communes proches de chez vous.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Création-des-tables">
<a class="anchor" href="#Cr%C3%A9ation-des-tables" aria-hidden="true"><span class="octicon octicon-link"></span></a>Création des tables<a class="anchor-link" href="#Cr%C3%A9ation-des-tables"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="n">bdd</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">"dis_db"</span><span class="p">)</span>
<span class="n">curseur</span> <span class="o">=</span> <span class="n">bdd</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Creation table Communes</span>
<span class="n">requete</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">CREATE TABLE Communes</span>
<span class="s2">(</span>
<span class="s2">    IdCommune INTEGER  PRIMARY KEY,</span>
<span class="s2">    inseecommune TEXT,</span>
<span class="s2">    nomcommune TEXT,</span>
<span class="s2">    quartier TEXT,</span>
<span class="s2">    cdreseau TEXT,</span>
<span class="s2">    nomreseau TEXT,</span>
<span class="s2">    debutalim DATE</span>
<span class="s2">);"""</span>
<span class="n">curseur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">requete</span><span class="p">)</span>

<span class="c1"># Creation des tables Prelevements et Resultats</span>

<span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

<span class="c1"># On enregistre les changements !</span>

<span class="n">bdd</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Alimentation-de-la-base-de-données">
<a class="anchor" href="#Alimentation-de-la-base-de-donn%C3%A9es" aria-hidden="true"><span class="octicon octicon-link"></span></a>Alimentation de la base de données<a class="anchor-link" href="#Alimentation-de-la-base-de-donn%C3%A9es"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Exemple d'import d'un fichier CSV dans une BDD</span>

<span class="kn">import</span> <span class="nn">csv</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'DIS_COM_UDI_2020.txt'</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">''</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
    <span class="n">nb_lignes</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">lignes</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span>
    <span class="n">entete</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lignes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entete</span><span class="p">:</span>
            <span class="n">entete</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nb_lignes</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">requete</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">            INSERT INTO Communes</span>
<span class="s2">                (inseecommune,nomcommune,quartier,cdreseau,nomreseau,debutalim)</span>
<span class="s2">            VALUES</span>
<span class="s2">                (?, ?, ?, ?, ?, ?)</span>
<span class="s2">            """</span>
            <span class="n">curseur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">requete</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
    <span class="n">bdd</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">nb_lignes</span><span class="si">}</span><span class="s2"> enregistrements créés"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Procédez de même pour le fichier prélèvement</span>

<span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">curseur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT COUNT(*) FROM Prelevements;"</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">curseur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">126730</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># et enfin le fichier Resultat</span>

<span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">curseur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">"SELECT COUNT(*) FROM Resultats;"</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">curseur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3683342</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Interrogation-de-la-base-de-données">
<a class="anchor" href="#Interrogation-de-la-base-de-donn%C3%A9es" aria-hidden="true"><span class="octicon octicon-link"></span></a>Interrogation de la base de données<a class="anchor-link" href="#Interrogation-de-la-base-de-donn%C3%A9es"> </a>
</h3>
<p>Nous avons à présent une vraie base de données avec de vraies données, en nombre conséquant. Une petite requête sur la table Resultats suffit pour s'en convaincre : Plus de 3 millions et demi d'enregistrements !</p>
<h3 id="Quelques-idées-de-fonctions-à-créer-!">
<a class="anchor" href="#Quelques-id%C3%A9es-de-fonctions-%C3%A0-cr%C3%A9er-!" aria-hidden="true"><span class="octicon octicon-link"></span></a>Quelques idées de fonctions à créer !<a class="anchor-link" href="#Quelques-id%C3%A9es-de-fonctions-%C3%A0-cr%C3%A9er-!"> </a>
</h3>
<ul>
<li>
<p>une fonction <strong>liste_communes</strong> prenant en entrée un curseur et un numéro de département et renvoyant la liste des communes dans de département présentes dans la base.</p>
<ul>
<li>La fonction ne renverra pas plusieurs fois la même commune</li>
<li>Attention, pour un numéro de département inférieur à 10, if faut penser à ajouter "0"...</li>
<li>Le champ <em>numeroinsee</em> commence par le numéro du département mais est différent du code postal.</li>
</ul>
</li>
<li>
<p>une fonction <strong>anomalies()</strong> prenant un curseur et un nom de commune et qui renvoie la date et la conclusion du prélévement (champ <em>conclusionprel</em> dans <strong>Prelevements</strong> dans la commune) et la référence du prélèvement (champ <em>referenceprel</em> dans ùùPrelevements**) en cas d'anomalie. Vous repèrerez dans la base la phrase type lorsque tout va bien !</p>
</li>
<li>
<p>une fonction <strong>resultat()</strong> prenant en paramètres un curseur et une référence de prélèvement et qui renvoie les résultats détaillés de l'analyse avec les informatiuons suivantes :</p>
<ul>
<li>libellé associé à chaque code paramètre, composant la dénomination du paramètre sous forme de texte libre</li>
<li>Le résultat de l’analyse physico-chimique ou microbiologique du paramètre</li>
<li>L'unité de mesure du paramètre</li>
<li>La limite(s) de qualité du paramètre concernéen vigueur  au moment du prélèvement</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="s2">"CAEN"</span> <span class="ow">in</span> <span class="n">liste_communes</span><span class="p">(</span><span class="n">curseur</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">anomalies</span><span class="p">(</span><span class="n">curseur</span><span class="p">,</span> <span class="s2">"HEROUVILLE-SAINT-CLAIR"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
<span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resultats</span><span class="p">(</span><span class="n">curseur</span><span class="p">,</span> <span class="s2">"01400207768"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Amusez-vous">
<a class="anchor" href="#Amusez-vous" aria-hidden="true"><span class="octicon octicon-link"></span></a>Amusez vous<a class="anchor-link" href="#Amusez-vous"> </a>
</h3>
<p>Interrogez la base de données pour rechercher des anomalies dans votre commune ou les environs, et récupérez les résultats détaillés des ananlyses en cas de problème pour identifier la source de l'anomalie.</p>
<p>Au fil de votre parcours de la base, vous pouvez avoir envie de créer d'autres fonctions pour afficher d'autres informations. Ne vous provez pas !!!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Amusez vous !</span>
<span class="n">liste_communes</span><span class="p">(</span><span class="n">curseur</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Pour-aller-plus-loin">
<a class="anchor" href="#Pour-aller-plus-loin" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pour aller plus loin<a class="anchor-link" href="#Pour-aller-plus-loin"> </a>
</h3>
<p>Vous avez les outils à présent pout construire une application graphique (avec TKInter par exemple) ou bien un site web mettant à disposition ces résultats. Cela peut faire l'objet d'un projet.</p>
<h2 id="Fin-du-travail">
<a class="anchor" href="#Fin-du-travail" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fin du travail<a class="anchor-link" href="#Fin-du-travail"> </a>
</h2>
<p>On n'oublie pas de fermer l'accès à la base de données :)</p>
<p>Vous aurez pu constater au cours de vos requêtes que les réponses de la base de donnée sont immédiate malgré les millions d'enregistrement que celle-ci contient !!</p>
<p>Voici un petit aperçu de l'utilisation d'une base de donnée dans le monde réel.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bdd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/python/nsi/terminale/bases%20de%20donn%C3%A9es/sql/tp/2020/06/25/nsi_t_baseDataGouv.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Plateforme de blog avec support pour Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/wawachief" title="wawachief"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/leclusemaths" title="leclusemaths"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
