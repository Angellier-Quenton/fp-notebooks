---
keywords: fastai
description: application socket serveur basique
title: Python 7 - Découverte du réseau et serveur
toc: true
badges: true
comments: false
categories: [ISN, socket]
nb_path: _notebooks/2020-03-07-Python7 - Reseau serveur.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-03-07-Python7 - Reseau serveur.ipynb
-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Partie-I-:-Adresses-r&#233;seau">Partie I : Adresses r&#233;seau<a class="anchor-link" href="#Partie-I-:-Adresses-r&#233;seau"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sur un réseau, chaque ordinateur a une adresse appelée adresse IP (Internet Protocol).
« Internet Protocol » est un mécanisme inventé pour le réseau internet mais qui est maintenant utilisé pratiquement tous les réseaux, y compris les petits réseaux domestiques.</p>
<p>Sur Internet, chaque machine connectée au réseau (ordinateur, téléphone, ...) possède une «adresse IP» unique. Cette adresse est constituée de 4 octets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>1) Combien de machines peut-on connecter sur Internet ?</p>
<p>Répondez ici...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>2) Ce protocole (nommé ipv4) a manifestement atteint ses limites. Un nouveau protocole, nommé ipv6 est en cours de déploiement sur Internet. Il utilise des adresses de 128 bits.
Combien de machines pourront être connectées simultanément grâce à ce nouveau protocole ?</p>
<p>Répondez ici...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>3) Ouvrir un terminal et taper à l’invite de commande la commande $\fbox{/sbin/ifconfig}$</p>
<p>a. Quelle est votre adresse IP ? ...</p>
<p>b. Quelle est l'adresse IP de votre voisin ? ...</p>
<p>c. Quelle partie votre adresse IP et celle de votre voisin ont-elle en commun ? ...</p>
<p>d. Vous pouvez tenter de communiquer avec votre voisin au travers de la commande
$\fbox{ping Adresse_Ip.De.Votre.Voisin}$ dans le terminal. Qu’obtenez-vous ?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Partie-II-:-Les-noms-sur-internet">Partie II : Les noms sur internet<a class="anchor-link" href="#Partie-II-:-Les-noms-sur-internet"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Les ordinateurs utilisent les adresses IP mais il est rare que les humains les retiennent : on préfère utiliser des noms.</p>
<p>Chaque ordinateur peut avoir un - ou plusieurs - nom. Dans un réseau il existe des ordinateurs dont la seule fonction est de tenir à jour les tables de correspondance entre les adresses IP et les noms dans une sorte d’annuaire semblable aux annuaires téléphoniques : les serveurs de noms (en abrégé <em>DNS</em>)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>1) Dans un terminal, taper $\fbox{ping lcs}$ puis $\fbox{ping google.fr}$ .</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>2) Quelle est l’adresse IP du Lcs ?</p>
<p>Répondez ici ...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>3) Quelle est l’adresse IP de Google.fr ?</p>
<p>Répondez ici ...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Partie-III-:-Principe-de-la-communication-Client/Serveur">Partie III : Principe de la communication Client/Serveur<a class="anchor-link" href="#Partie-III-:-Principe-de-la-communication-Client/Serveur"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Un ordinateur (le <strong><em>serveur</em></strong>) fait tourner en permanence un programme (un <strong><em>service</em></strong>) qui</p>
<ul>
<li>attend que d’autres ordinateurs (les <strong><em>clients</em></strong>) le sollicitent</li>
<li>gère les échanges une fois la liaison établie</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>1) Citer des exemples de communications client/serveur dans vos usages quotidien des réseaux.</p>
<p>Votre réponse ici ...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>2) Pour ces exemples, décrire le rôle du serveur et du client.</p>
<p>Votre réponse ici</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Partie-IV-:-Ecrire-un-programme-serveur-en-Python">Partie IV : Ecrire un programme serveur en Python<a class="anchor-link" href="#Partie-IV-:-Ecrire-un-programme-serveur-en-Python"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Voici un programme serveur basique écrit en Python. On utilise ici la librairie <strong><em>socket</em></strong> qui gère la communication réseau en Python.</p>
<p>Exécutez cette cellule puis ouvrez le classeur <strong>Python7 - Reseau client</strong> pour exécuter la partie cliente.</p>
<p>Remarquez que quand le serveur tourne, le kernel python est monopolisé et ne permet plus l'exécution d'une autre cellule, d'où la nécessité de changer de classeur pour la partie cliente.</p>
<p>Néanmoins, vous pourrez compléter la section suivante sur la compréhension du programme et répondre aux questions posées pendant que le serveur tourne.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Le-programme-serveur">Le programme serveur<a class="anchor-link" href="#Le-programme-serveur"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">socket</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">### Mise en place du service ########</span>
<span class="n">MON_IP</span> <span class="p">,</span><span class="n">PORT</span> <span class="o">=</span> <span class="s1">&#39;127.0.0.1&#39;</span> <span class="p">,</span> <span class="mi">50000</span>
<span class="n">service</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">service</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="n">MON_IP</span> <span class="p">,</span> <span class="n">PORT</span><span class="p">))</span>
    <span class="n">tourne</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="n">error</span> <span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Impossible de démarrer le service.&quot;</span><span class="p">)</span>
    <span class="n">tourne</span> <span class="o">=</span> <span class="kc">False</span>
    
<span class="k">while</span> <span class="n">tourne</span> <span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Serveur prêt, en attente de requètes ...&quot;</span><span class="p">)</span>
    <span class="n">service</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1">### Mise en place d?une connexion ########</span>
    <span class="n">connexion</span><span class="p">,</span> <span class="n">adresse</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Client connecté. : &quot;</span><span class="p">,</span><span class="n">adresse</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1">### Dialogue avec le client ########</span>
    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">while</span> <span class="n">message</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;FIN&quot;</span> <span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;moi &gt; &quot;</span><span class="p">)</span>
        <span class="n">connexion</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;FIN&quot;</span> <span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">connexion</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;client &gt; &quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="n">connexion</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="n">ch</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;&lt;R&gt;ecommencer &lt;T&gt;erminer ? &quot;</span><span class="p">)</span>
    <span class="n">ch</span> <span class="o">=</span> <span class="n">ch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span><span class="s1">&#39;T&#39;</span><span class="p">:</span>
        <span class="n">tourne</span> <span class="o">=</span> <span class="kc">False</span>
    
<span class="n">service</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Compr&#233;hension-du-programme-serveur">Compr&#233;hension du programme serveur<a class="anchor-link" href="#Compr&#233;hension-du-programme-serveur"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>1) Sur quelle adresse IP le serveur va t-il répondre ?</p>
<p>Votre réponse ...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>2) Une même machine peut héberger plusieurs services (programmes serveur). En effet le Lcs héberge un serveur web, un serveur de base de données, des services de messagerie, etc... . Pour éviter que ces services entrent en conflit, on utilise en plus de l’adresse IP un numéro de port qui peut être vu comme un canal de communication. Ce numéro de port est compris entre 1024 et 65535.</p>
<p>a. Quel numéro de port est utilisé dans le programme étudié ? ...</p>
<p>b. Changer le numéro de port sur le serveur. Que se passe t-il au niveau du client ? ...</p>
<p>c. Adapter également le numéro de port sur le client. Le programme fonctionne t-il à nouveau ? ...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>3) Quelle commande est responsable sur le serveur de l’envoi du message au client ?</p>
<p>Votre réponse ...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>4) Écrire en langage naturel l’algorithme correspondant au serveur</p>
<p>Votre réponse ...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>5) Quel message taper coté client ou serveur pour mettre fin à la communication ?</p>
<p>Votre réponse ...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="A-vous-de-jouer-:-Jeu-du-juste-prix-en-r&#233;seau">A vous de jouer : Jeu du juste prix en r&#233;seau<a class="anchor-link" href="#A-vous-de-jouer-:-Jeu-du-juste-prix-en-r&#233;seau"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>L’objectif de l’activité est de réaliser un jeu de juste prix en réseau.</p>
<p>1) Décrire le rôle du serveur et du client.</p>
<p>Votre réponse ...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>2) Écrire l’algorithme en langage naturel d’un jeu de juste prix en réseau. Vous devrez pour cela écrire l’algorithme du serveur et du client.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>3) en vous aidant des commandes vues dans l’exemple étudier, modifier le programme serveur
étudié afin de programmer un jeu de juste prix en réseau. On pourra essayer de deviner un nombre
entier entre 1 et 100.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Votre programme ici...</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

